{% set analytics_service = config.extra.analytics.service %}
{% set analytics_id = config.extra.analytics.id | default(value="") %}
{% set self_hosted_url = config.extra.analytics.self_hosted_url | default(value="") %}

{% if analytics_service == "goatcounter" %}
    {% if self_hosted_url %}
        <script 
            data-goatcounter="{{ self_hosted_url ~ '/count' }}"
            async 
            src="{{ self_hosted_url ~ '/count.js' }}">
        </script>
    {% else %}
        <script 
            data-goatcounter="https://{{ analytics_id }}.goatcounter.com/count" 
            async 
            src="//gc.zgo.at/count.js">
        </script>
    {% endif %}

{% elif analytics_service == "umami" %}
    {% if self_hosted_url %}
        <script 
            async defer 
            data-website-id="{{ analytics_id }}" 
            src="{{ self_hosted_url ~ '/umami.js' }}">
        </script>
    {% else %}
        <script 
            async defer 
            data-website-id="{{ analytics_id }}" 
            src="https://analytics.eu.umami.is/script.js">
        </script>
    {% endif %}

    {% elif analytics_service == "plausible" %}
    <script 
        defer 
        data-domain="{{ analytics_id }}" 
        src="{% if self_hosted_url %}{{ self_hosted_url ~ '/js/plausible.js' }}{% else %}https://plausible.io/js/script.js{% endif %}"
    ></script>
{% endif %}
